---
wave: 1
depends_on: []
files_modified:
  - src/services/stt.ts
  - src/services/tts.ts
  - src/services/conversation.ts
autonomous: true
---

# Plan 06-02: Remove Legacy Provider Code

## Objective

Delete the old provider modules that used Deepgram, ElevenLabs, and OpenAI. These have been replaced by AWS equivalents (aws-transcribe-stt.ts, aws-polly-tts.ts, bedrock-conversation.ts). Per Phase 6 context, code should be deleted entirely rather than moved to a legacy folder.

## Requirements Addressed

- INFRA-03: Old provider SDK dependencies removed (prepares for package.json cleanup)
- Cleanup technical debt from migration

## Tasks

<task id="1" title="Verify no imports of legacy modules">
Before deleting, verify that no production code imports these modules:

```bash
# Check for imports of old stt.ts
grep -r "from './stt'" src/ --include="*.ts" | grep -v ".test.ts" | grep -v "stt.ts"

# Check for imports of old tts.ts
grep -r "from './tts'" src/ --include="*.ts" | grep -v ".test.ts" | grep -v "tts.ts"

# Check for imports of old conversation.ts
grep -r "from './conversation'" src/ --include="*.ts" | grep -v ".test.ts" | grep -v "conversation.ts"
```

Expected: No matches (or only matches in test files that also need updating).
</task>

<task id="2" title="Delete legacy STT module" depends_on="1">
Delete the Deepgram STT module:

```bash
rm /workspace/src/services/stt.ts
```

This file contained `DeepgramSTT` class that used `@deepgram/sdk`.
Replaced by: `AWSTranscribeSTT` in aws-transcribe-stt.ts
</task>

<task id="3" title="Delete legacy TTS module" depends_on="1">
Delete the ElevenLabs/Deepgram TTS module:

```bash
rm /workspace/src/services/tts.ts
```

This file contained `TTSService` class that used ElevenLabs and Deepgram TTS.
Replaced by: `AWSPollyTTS` in aws-polly-tts.ts
</task>

<task id="4" title="Delete legacy conversation module" depends_on="1">
Delete the OpenAI conversation module:

```bash
rm /workspace/src/services/conversation.ts
```

This file contained OpenAI-based conversation handling with tool calling.
Replaced by: bedrock-conversation.ts using AWS Bedrock Claude.
</task>

<task id="5" title="Verify TypeScript compilation" depends_on="2,3,4">
Ensure the codebase still compiles after deletions:

```bash
npx tsc --noEmit
```

Expected: No errors. All production code should import from AWS modules.
</task>

<task id="6" title="Verify tests still pass" depends_on="5">
Run the full test suite to ensure nothing broke:

```bash
npm test
```

Expected: All tests pass. Any test that imported legacy modules should have been updated in previous phases.
</task>

## Verification

- [ ] No production code imports from stt.ts, tts.ts, or conversation.ts
- [ ] src/services/stt.ts deleted
- [ ] src/services/tts.ts deleted
- [ ] src/services/conversation.ts deleted
- [ ] TypeScript compiles: `npx tsc --noEmit`
- [ ] All tests pass: `npm test`

## must_haves

- [ ] Delete stt.ts (Deepgram STT)
- [ ] Delete tts.ts (ElevenLabs/Deepgram TTS)
- [ ] Delete conversation.ts (OpenAI conversation)
- [ ] Codebase compiles and tests pass after deletion
